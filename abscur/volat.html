<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ВОЛАТИЛЬНОСТЬ АБСОЛЮТНАЯ</title>
    <link rel="stylesheet" href="style.css?6">
    
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">ГЛАВНАЯ</a></li>
            <li><a href="last-abs.html">ДОХОДНОСТЬ АБСОЛЮТНАЯ</a></li>
            <li><a href="volat.html">ВОЛАТИЛЬНОСТЬ АБСОЛЮТНАЯ</a></li>
            <li><a href="last-par.html">ДОХОДНОСТЬ ПАРНАЯ</a></li>
            <li><a href="papers.html">О ПРОЕКТЕ</a></li>
        </ul>
    </nav>
    
    <div class="content">
        <h1>ВОЛАТИЛЬНОСТЬ АБСОЛЮТНАЯ</h1>
        <br/>

        Волатильность считается для <a href="last-abs.html">абсолютных валютных курсов</a>. 
        Волатильность считается как отношение <a href="https://ru.wikipedia.org/wiki/%D0%A1%D1%80%D0%B5%D0%B4%D0%BD%D0%B5%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5_%D0%BE%D1%82%D0%BA%D0%BB%D0%BE%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5" target="_blank">статндартного отклонения</a> к среднему значению абсолютного валютного курса за определенный временной промежуток в процентах.
        Пересчет происходит каждые два часа.
        Здесь представляена волатильность для дневных абсолютных валютных курсов.
        Цвет определяет положение относительно среднего значения в столбце среди других валют (красное - волатильность выше среднего, зеленое - волатильность ниже среднего).
        Ниже в таблице приведены волатильности для всех валют для разных временных промежутков.
        Сортировать рейтинги в таблице можно нажатием на соответствующем столбце.
        Переход к странице валюты осуществляется по ссылке из первого столбца.

        <br/>
        <br/>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript">
            google.charts.load('current', {'packages':['table']});
            // google.charts.load('current', {'packages':['corechart']});
            var ssid = "1CrNvvV-p6XG7lSJXftPKk_aY4nuH4WK25rPxaNKrM3U" ;
            google.charts.setOnLoadCallback(function (){
                // запрос к таблице
                var queryString = encodeURIComponent("'Волатильность абсолютная'!A1:J46");
                var URL = 'https://docs.google.com/spreadsheets/d/' + ssid + '/gviz/tq?headers=0&range=' + queryString  ;
                var query = new google.visualization.Query(URL) ;
                query.send(function (response)
                {
                    var data = response.getDataTable();
                    var cnt_c = data.getNumberOfColumns() ;
                    var cnt_r = data.getNumberOfRows() ;

                    data = data.clone() ;

                    $('#div_cur_date').text('Дата: ' + data.getValue(0,1)) ;

                    data.removeRow(0) ;
                    data.removeColumn(0) ;

                    data.setColumnLabel(0,"Валюта") ;
                    data.setColumnLabel(1,"Курс") ;
                    data.setColumnLabel(2,"НЕДЕЛЯ") ;
                    data.setColumnLabel(3,"МЕСЯЦ") ;
                    data.setColumnLabel(4,"КВАРТАЛ") ;
                    data.setColumnLabel(5,"ПОЛГОДА") ;
                    data.setColumnLabel(6,"ГОД") ;
                    data.setColumnLabel(7,"3 ГОДА") ;
                    data.setColumnLabel(8,"5 ЛЕТ") ;
                    
                    for(var i=0;i<data.getNumberOfRows();i++)
                    {
                        var name = data.getValue(i,0) ;
                        var link = '<a href=abs.html?val=' + encodeURIComponent(name) + '>' + name.toUpperCase()+ '</a>' ;
                        data.setCell(i,0,link) ;
                    }

                    for(let i=2;i<9;i++)
                    {
                        let sum = 0 ;
                        for(let r=0;r<data.getNumberOfRows();r++)
                            sum += data.getValue(r,i) ;
                        
                        let formatter = new google.visualization.ColorFormat() ;
                        formatter.addRange(-100000, sum/data.getNumberOfRows()-0.0000000000001, 'yellow', 'blue') ;
                        formatter.addRange(sum/data.getNumberOfRows()+0.0000000000001,100000, 'yellow', 'red') ;
                        formatter.format(data, i) ;
                    }
                    
                    var table = new google.visualization.Table(document.getElementById('div_table'));

                    table.draw(data, {sortColumn:2, sortAscending:false, allowHtml: true,showRowNumber: false, height: '100%'});
                    
                });
                
            }) ;
            
        </script>

        <div id="div_cur_date">...Загрузка даты...</div>
        <br/>
        <div id="div_table">...Загрузка таблицы...</div>
        
        <br/><br/>

        <img src="abscur_znak.jpg">

        <div>Зеркала на <a href="https://www.abscur.ru/p/blog-page_26.html">www.abscur.ru</a> и на <a href="https://prog815.github.io/abscur/volat.html">prog815.github.io</a></div>

    </div>
</body>
</html>