<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Доходность (парные валютные курсы)</title>
    <link rel="stylesheet" href="menu.css">
</head>
<body>
    <div class="sidenav">
        <a href="index.html">ГЛАВНАЯ</a>
        <a href="last-abs.html">ДОХОДНОСТЬ ВАЛЮТ</a>
        <a href="volat.html">ВОЛАТИЛЬНОСТЬ ВАЛЮТ</a>
        <a href="last-par.html">ДОХОДНОСТЬ ПАРНЫХ</a>
        <a href="papers.html">О ПРОЕКТЕ</a>
    </div>

    <div class="main">

        <h1>Доходность (парные валютные курсы)</h1>
        <br/>
        <div id="div_cur_date">...Загрузка даты...</div>
        <br/>
        <div id="div_table">...Загрузка таблицы...</div>

        <br/>

        <div>Зеркала на <a href="https://www.abscur.ru/p/blog-page_57.html">www.abscur.ru</a> и на <a href="https://prog815.github.io/abscur/last-par.html">prog815.github.io</a></div>
        
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.js"></script>

        <script type="text/javascript">
            
            google.charts.load('current', {'packages':['table']});
            var ssid = "1CrNvvV-p6XG7lSJXftPKk_aY4nuH4WK25rPxaNKrM3U" ;

            // ------------------------------------------------------
            // запуск начального

            google.charts.setOnLoadCallback(function (){
                start("'Парные валютные курсы'!A1:J88",function (response){
                    var data = response.getDataTable();

                    $('#div_cur_date').text('Дата: ' + data.getColumnLabel(1).toString().substring(8)) ;

                    data.setColumnLabel(0,"ПАРА") ;
                    data.setColumnLabel(1,"КУРС") ;
                    data.setColumnLabel(2,"ДЕНЬ") ;
                    data.setColumnLabel(3,"НЕДЕЛЯ") ;
                    data.setColumnLabel(4,"МЕСЯЦ") ;
                    data.setColumnLabel(5,"КВАРТАЛ") ;
                    data.setColumnLabel(6,"ПОЛГОДА") ;
                    data.setColumnLabel(7,"ГОД") ;
                    data.setColumnLabel(8,"3 ГОДА") ;
                    data.setColumnLabel(9,"5 ЛЕТ") ;

                    for(var i=0;i<data.getNumberOfRows();i++)
                    {
                        var name = data.getValue(i,0) ;
                        var link = '<a href=par.html?par=' + encodeURIComponent(name) + '>' + name.toUpperCase()+ '</a>' ;
                        data.setCell(i,0,link) ;
                    }

                    var formatter = new google.visualization.ColorFormat();
                    formatter.addRange(-100, -0.0000000000001, 'yellow', 'red');
                    formatter.addRange(0.0000000000001,100, 'yellow', 'green');
                    for(let i=2;i<10;i++)
                        formatter.format(data, i);
                    

                    var table = new google.visualization.Table(document.getElementById('div_table'));

                    table.draw(data, {sortColumn:2, sortAscending:false, allowHtml: true,showRowNumber: false, height: '100%'});
                }) ;
            }) ;
            
            // -------------------------------------------------------
            // библиотека

            function start(query,func) {
                var queryString = encodeURIComponent(query);
                var URL = 'https://docs.google.com/spreadsheets/d/' + ssid + '/gviz/tq?range=' + queryString  ;
                var query = new google.visualization.Query(URL) ;
                query.send(func);
            } ;
        </script>


    </div>
</body>
</html>