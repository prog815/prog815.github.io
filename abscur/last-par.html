<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ДОХОДНОСТЬ ПАРНАЯ</title>
    <link rel="stylesheet" href="style.css?6">
    
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">ГЛАВНАЯ</a></li>
            <li><a href="last-abs.html">ДОХОДНОСТЬ АБСОЛЮТНАЯ</a></li>
            <li><a href="volat.html">ВОЛАТИЛЬНОСТЬ АБСОЛЮТНАЯ</a></li>
            <li><a href="last-par.html">ДОХОДНОСТЬ ПАРНАЯ</a></li>
            <li><a href="papers.html">О ПРОЕКТЕ</a></li>
        </ul>
    </nav>
    
    <div class="content">

        <h1>ДОХОДНОСТЬ ПАРНАЯ</h1>

        <br/>

        Парные валютные курсы получаем с <a href="https://finance.yahoo.com/" target="_blank">Yahoo.Finance</a>. 
        Представленные курсы дневные. 
        История парных валютных курсов за последние 5 лет доступна по <a href="https://docs.google.com/spreadsheets/d/1CrNvvV-p6XG7lSJXftPKk_aY4nuH4WK25rPxaNKrM3U/edit#gid=1972433312" target="_blank">ссылке</a>. 
        Для надежности курсы обновляются каждые 2 часа.
        Из парных валютных курсов расчитываются <a href=last-abs.html>абсолютные валютные курсы</a>.
        Ниже таблица с относительными изменениями парных валютных курсов за разные временные интервалы. 
        Положительные значения выделены зеленым цетом, отрицательные красным. 
        Рейтинги валютных пар можно сортировать нажатием в заголовках соответствующих столбцов таблицы. 
        Для перехода к странице конкретной валютной пары можно воспользоваться ссылкой из первого столбца.

        <br/>
        <br/>


        <div id="div_cur_date">...Загрузка даты...</div>
        <br/>
        <div id="div_table">...Загрузка таблицы...</div>

        <br/><br/>

        <img src="abscur_znak.jpg">

        <div>Зеркала на <a href="https://www.abscur.ru/p/blog-page_57.html">www.abscur.ru</a> и на <a href="https://prog815.github.io/abscur/last-par.html">prog815.github.io</a></div>
        
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.js"></script>

        <script type="text/javascript">
            
            google.charts.load('current', {'packages':['table']});
            var ssid = "1CrNvvV-p6XG7lSJXftPKk_aY4nuH4WK25rPxaNKrM3U" ;

            // ------------------------------------------------------
            // запуск начального

            google.charts.setOnLoadCallback(function (){
                start("'Парные валютные курсы'!A1:J88",function (response){
                    var data = response.getDataTable();

                    $('#div_cur_date').text('Дата: ' + data.getColumnLabel(1).toString().substring(8)) ;

                    data.setColumnLabel(0,"ПАРА") ;
                    data.setColumnLabel(1,"КУРС") ;
                    data.setColumnLabel(2,"ДЕНЬ") ;
                    data.setColumnLabel(3,"НЕДЕЛЯ") ;
                    data.setColumnLabel(4,"МЕСЯЦ") ;
                    data.setColumnLabel(5,"КВАРТАЛ") ;
                    data.setColumnLabel(6,"ПОЛГОДА") ;
                    data.setColumnLabel(7,"ГОД") ;
                    data.setColumnLabel(8,"3 ГОДА") ;
                    data.setColumnLabel(9,"5 ЛЕТ") ;

                    for(var i=0;i<data.getNumberOfRows();i++)
                    {
                        var name = data.getValue(i,0) ;
                        var link = '<a href=par.html?par=' + encodeURIComponent(name) + '>' + name.toUpperCase()+ '</a>' ;
                        data.setCell(i,0,link) ;
                    }

                    var formatter = new google.visualization.ColorFormat();
                    formatter.addRange(-100, -0.0000000000001, 'yellow', 'red');
                    formatter.addRange(0.0000000000001,100, 'yellow', 'green');
                    for(let i=2;i<10;i++)
                        formatter.format(data, i);
                    

                    var table = new google.visualization.Table(document.getElementById('div_table'));

                    table.draw(data, {sortColumn:2, sortAscending:false, allowHtml: true,showRowNumber: false, height: '100%'});
                }) ;
            }) ;
            
            // -------------------------------------------------------
            // библиотека

            function start(query,func) {
                var queryString = encodeURIComponent(query);
                var URL = 'https://docs.google.com/spreadsheets/d/' + ssid + '/gviz/tq?range=' + queryString  ;
                var query = new google.visualization.Query(URL) ;
                query.send(func);
            } ;
        </script>


    </div>

    <!-- Yandex.Metrika counter -->
        <script type="text/javascript" >
            (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
            (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
            ym(37941595, "init", {
                clickmap:true,
                trackLinks:true,
                accurateTrackBounce:true
            });
        </script>
        <noscript><div><img src="https://mc.yandex.ru/watch/37941595" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</body>
</html>